<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>EFOOTBALL CAMPEONATO</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">

<style>
:root{
 --primary:#00ff88;--bg:#05070a;--card:#12161d;--text:#e0e0e0;
 --border:#232931;--gold:#ffaa00;--accent:#ff0055;
}
*{box-sizing:border-box}
body{margin:0;font-family:Montserrat;background:var(--bg);color:var(--text);padding-bottom:80px}

/* HEADER */
header{text-align:center;padding:20px 0;background:#000;border-bottom:2px solid var(--primary)}
.plan-badge{
display:inline-block;
margin-top:6px;
font-size:10px;
font-weight:900;
padding:4px 10px;
border-radius:20px;
}
.free{background:#444;color:#fff}
.pro{background:var(--gold);color:#000}

/* LAYOUT */
.container{max-width:800px;margin:auto;padding:12px}
.card{
background:var(--card);
border:1px solid var(--border);
border-radius:12px;
padding:12px;
margin-bottom:20px;
}

/* TABLE */
table{width:100%;border-collapse:collapse;font-size:11px}
th,td{padding:8px;text-align:center}
th{font-size:9px;color:#777}
.name{text-align:left;font-weight:700}

/* BUTTONS */
.btn{
width:100%;
padding:12px;
border:none;
border-radius:8px;
font-weight:900;
font-size:11px;
cursor:pointer;
margin-top:8px;
}
.btn-primary{background:var(--primary);color:#000}
.btn-gold{background:var(--gold);color:#000}
.btn-dark{background:#333;color:#fff}
.btn-upgrade{background:var(--accent);color:#fff}

/* ADMIN */
input{
width:100%;
padding:10px;
border-radius:6px;
border:1px solid #333;
background:#000;
color:#fff;
margin-bottom:8px;
}
</style>
</head>

<body>

<header>
  <div style="font-size:18px;font-weight:900">
    EFOOTBALL <span style="color:var(--primary)">CAMPEONATO</span>
  </div>
  <span id="planBadge" class="plan-badge free">FREE</span>
</header>

<div class="container">

<!-- CLASSIFICAÃ‡ÃƒO -->
<div class="card">
<table>
<thead>
<tr>
<th>#</th>
<th style="text-align:left">Jogador</th>
<th>P</th><th>V</th><th>E</th><th>D</th><th>SG</th>
</tr>
</thead>
<tbody id="tabela"></tbody>
</table>
</div>

<!-- ADMIN -->
<div id="admin-panel" class="card">
<h4 style="color:var(--primary);margin:0 0 10px">PAINEL DO TORNEIO</h4>

<input id="playerName" placeholder="Nome do jogador">
<button class="btn btn-primary" onclick="addPlayer()">ADICIONAR JOGADOR</button>

<button class="btn btn-gold" onclick="gerarJogos()">GERAR JOGOS</button>

<div id="upgradeBox" style="display:none;margin-top:10px">
<button class="btn btn-upgrade" onclick="upgrade()">ATIVAR PRO</button>
</div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js";
import { getFirestore, collection, addDoc, onSnapshot, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";

/* FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyDVSyYqthdpYZmtHtfljrlGs6p9r6MtL4U",
  authDomain: "efootball-league-f71ac.firebaseapp.com",
  projectId: "efootball-league-f71ac"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let uid = null;
let jogadores = [];
let plano = "FREE";

/* AUTH */
onAuthStateChanged(auth, async (user)=>{
 if(!user){
   window.location.href="index.html";
   return;
 }
 uid = user.uid;
 await loadConfig();
 loadPlayers();
});

/* CONFIG (FREE / PRO) */
async function loadConfig(){
 const ref = doc(db,"users",uid,"config","plano");
 const snap = await getDoc(ref);
 if(!snap.exists()){
   await setDoc(ref,{tipo:"FREE"});
   plano="FREE";
 }else{
   plano = snap.data().tipo;
 }
 renderPlan();
}

function renderPlan(){
 const badge=document.getElementById("planBadge");
 const upgrade=document.getElementById("upgradeBox");
 if(plano==="PRO"){
   badge.textContent="PRO";
   badge.className="plan-badge pro";
   upgrade.style.display="none";
 }else{
   badge.textContent="FREE";
   badge.className="plan-badge free";
   upgrade.style.display="block";
 }
}

/* PLAYERS */
function loadPlayers(){
 const ref = collection(db,"users",uid,"jogadores");
 onSnapshot(ref,snap=>{
   jogadores = snap.docs.map(d=>({id:d.id,...d.data()}));
   renderTable();
 });
}

window.addPlayer = async ()=>{
 if(plano==="FREE" && jogadores.length>=4){
   alert("ðŸš« Plano FREE permite atÃ© 4 jogadores");
   return;
 }
 const n=document.getElementById("playerName").value;
 if(!n) return;
 await addDoc(collection(db,"users",uid,"jogadores"),{
   nome:n,pts:0,v:0,e:0,d:0,sg:0
 });
 document.getElementById("playerName").value="";
};

function renderTable(){
 document.getElementById("tabela").innerHTML =
 jogadores.map((p,i)=>`
 <tr>
  <td>${i+1}</td>
  <td class="name">${p.nome}</td>
  <td>${p.pts}</td>
  <td>${p.v}</td>
  <td>${p.e}</td>
  <td>${p.d}</td>
  <td>${p.sg}</td>
 </tr>`).join("");
}

/* PLACEHOLDERS */
window.gerarJogos = ()=>{
 alert("âš™ï¸ Gerador completo disponÃ­vel no PRO");
};

window.upgrade = ()=>{
 alert("ðŸ’Ž Em breve: ativaÃ§Ã£o PRO por cÃ³digo / PIX");
};
</script>

</body>
</html>
